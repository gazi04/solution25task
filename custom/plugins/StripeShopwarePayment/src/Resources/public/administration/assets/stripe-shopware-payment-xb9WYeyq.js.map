{"version":3,"file":"stripe-shopware-payment-xb9WYeyq.js","sources":["../../../app/administration/src/module/stripe-settings/page/stripe-plugin-settings/stripe-plugin-settings.html.twig","../../../app/administration/src/module/stripe-settings/page/stripe-plugin-settings/index.js","../../../app/administration/src/module/stripe-settings/components/stripe-settings-icon/stripe-settings-icon.html.twig","../../../../../../../../vendor/shopware/administration/Resources/app/administration/node_modules/.shopware-vite-plugin-vue-globals/vue.js","../../../app/administration/src/module/stripe-settings/components/stripe-settings-icon/stripe-shopware-payment-icon-plugin.svg","../../../app/administration/src/module/stripe-settings/components/stripe-settings-icon/index.js","../../../app/administration/src/module/stripe-settings/index.js","../../../app/administration/node_modules/@stripe/stripe-js/dist/stripe.esm.js","../../../app/administration/src/services/stripe-shopware-payment-config-api-service.js","../../../app/administration/src/services/stripe-shopware-payment-webhook-registration-service.js","../../../app/administration/src/services/index.js"],"sourcesContent":["{% block stripe_payment %}\n    <sw-page>\n        <template #smart-bar-header>\n            <h2>\n                {{ $t('sw-settings.index.title') }}\n                <mt-icon\n                        v-if=\"shopwareVersion.startsWith('6.7')\"\n                        small\n                        name=\"regular-chevron-right-xs\"\n                />\n                <sw-icon\n                        v-else\n                        small\n                        name=\"regular-chevron-right-xs\"\n                />\n                {{ $t('stripe-shopware-payment-config-page.smart-bar.title') }}\n            </h2>\n        </template>\n\n        <template #smart-bar-actions>\n            <mt-button v-if=\"shopwareVersion.startsWith('6.7')\" :routerLink=\"{ name: 'sw.settings.index' }\">\n                {{ $t('stripe-shopware-payment-config-page.smart-bar.cancel') }}\n            </mt-button>\n            <sw-button v-else :routerLink=\"{ name: 'sw.settings.index' }\">\n                {{ $t('stripe-shopware-payment-config-page.smart-bar.cancel') }}\n            </sw-button>\n\n            {% block stripe_shopware_payment__payment_config_page__save_settings_button %}\n                <sw-button-process\n                        variant=\"primary\"\n                        :isLoading=\"isLoading\"\n                        :disabled=\"isLoading\"\n                        :processSuccess=\"isSaveSuccessful\"\n                        @click=\"saveConfig\"\n                >\n                    {{ $t('stripe-shopware-payment-config-page.smart-bar.save') }}\n                </sw-button-process>\n            {% endblock %}\n        </template>\n\n        <template #content>\n            {% block stripe_shopware_payment__payment_config_page__main_content %}\n                <sw-card-view>\n                    {% block stripe_shopware_payment__payment_config_page__above_system_config_card %}\n                    {% endblock %}\n\n                    <sw-system-config\n                            ref=\"systemConfig\"\n                            salesChannelSwitchable\n                            :domain=\"configDomain\"\n                            @config-changed=\"updateConfig\"\n                    />\n\n                    {% block stripe_shopware_payment__payment_config_page__below_system_config_card %}\n                    {% endblock %}\n                </sw-card-view>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n","const { Component, Mixin } = Shopware;\nconst { object, types } = Shopware.Utils;\n\nimport template from './stripe-plugin-settings.html.twig';\n\nconst WEBHOOK_RESULT_CREATED = 'created';\nconst WEBHOOK_RESULT_UPDATED = 'updated';\nconst WEBHOOK_RESULT_NO_CHANGES = 'no_changes';\nconst STRIPE_CONFIG_DOMAIN = 'StripeShopwarePayment.sales-channel-plugin-config';\n\nComponent.register('stripe-plugin-settings', {\n    template,\n\n    mixins: [\n        Mixin.getByName('notification'),\n    ],\n\n    inject: [\n        'stripeShopwarePaymentWebhookRegistrationService',\n        'stripeShopwarePaymentConfigApiService',\n    ],\n\n    data() {\n        return {\n            isLoading: false,\n            isSaveSuccessful: false,\n            config: null,\n            configDomain: STRIPE_CONFIG_DOMAIN,\n            publishableKeyValid: false,\n            secretKeyValid: false,\n            shopwareVersion: Shopware.Context.app.config.version\n        };\n    },\n\n    computed: {\n        globalConfig() {\n            return this.$refs.systemConfig.actualConfigData.null || {};\n        },\n    },\n\n    metaInfo() {\n        return { title: this.$createTitle(this.$t('stripe-shopware-payment-config-page.title')) };\n    },\n\n    methods: {\n        async saveConfig() {\n            this.isLoading = true;\n\n            try {\n                await this.$refs.systemConfig.saveAll();\n                this.isSaveSuccessful = true;\n                this.createNotificationSuccess({\n                    title: this.$t('stripe-shopware-payment-config-page.controller.titles.success'),\n                    message: this.$t('stripe-shopware-payment-config-page.controller.messages.save.success'),\n                });\n            } catch (error) {\n                this.isSaveSuccessful = false;\n                let errorMessage = error.response && error.response.data;\n                if (!errorMessage) {\n                    errorMessage = this.$t('stripe-shopware-payment-config-page.controller.messages.unknown-error');\n                }\n                this.createNotificationError({\n                    title: this.$t('stripe-shopware-payment-config-page.controller.titles.error'),\n                    message: this.$t(\n                        'stripe-shopware-payment-config-page.controller.messages.save.error',\n                        { errorMessage },\n                    ),\n                });\n                this.isLoading = false;\n\n                return;\n            }\n\n            await this.validateCredentials();\n            // Only register a webhook for the current sales channel when it has its own secret key to prevent the\n            // creation of multiple webhook endpoints for the same (global) credentials.\n            if (this.secretKeyValid && this.getConfigValue(this.config, 'stripeSecretKey')) {\n                try {\n                    await Promise.all([\n                        this.registerWebhook(),\n                        this.updateStripeAccountCountry(),\n                    ]);\n                } finally {\n                    // It is currently not possible to reload the config, delete the current config and fetch it\n                    // again instead.\n                    delete this.$refs.systemConfig.actualConfigData[this.$refs.systemConfig.currentSalesChannelId];\n                    await this.$refs.systemConfig.readAll();\n                }\n            }\n\n            this.isLoading = false;\n        },\n\n        updateConfig(config) {\n            this.config = config;\n            this.isSaveSuccessful = false;\n        },\n\n        async validateCredentials() {\n            const publishableKey = this.getConfigValueWithInheritance('stripePublicKey');\n            const secretKey = this.getConfigValueWithInheritance('stripeSecretKey');\n            const validationPromises = [];\n            validationPromises.push(this.stripeShopwarePaymentConfigApiService.validateSecretKey(\n                secretKey,\n            ));\n            if (publishableKey) {\n                validationPromises.push(this.stripeShopwarePaymentConfigApiService.validatePublishableKey(\n                    publishableKey,\n                ));\n            } else {\n                validationPromises.push(true);\n            }\n            try {\n                [this.secretKeyValid, this.publishableKeyValid] = await Promise.all(validationPromises);\n            } catch (error) {\n                this.createNotificationError({\n                    title: this.$t('stripe-shopware-payment-config-page.controller.titles.error'),\n                    message: this.$t('stripe-shopware-payment-config-page.controller.messages.credentials.error', {\n                        errorMessage: error.message,\n                    }),\n                });\n\n                return;\n            }\n            this.showCredentialsNotification();\n        },\n\n        async registerWebhook() {\n            try {\n                const currentSalesChannelId = this.$refs.systemConfig.currentSalesChannelId;\n                const response = await this.stripeShopwarePaymentWebhookRegistrationService.registerWebhook(\n                    currentSalesChannelId,\n                );\n                switch (response.result) {\n                    case WEBHOOK_RESULT_CREATED:\n                        this.createNotificationSuccess({\n                            title: this.$t('stripe-shopware-payment-config-page.controller.titles.success'),\n                            message: this.$t('stripe-shopware-payment-config-page.controller.messages.webhook.created'),\n                        });\n                        break;\n                    case WEBHOOK_RESULT_UPDATED:\n                        this.createNotificationSuccess({\n                            title: this.$t('stripe-shopware-payment-config-page.controller.titles.success'),\n                            message: this.$t('stripe-shopware-payment-config-page.controller.messages.webhook.updated'),\n                        });\n                        break;\n                    case WEBHOOK_RESULT_NO_CHANGES:\n                        break;\n                    default:\n                        this.createNotificationError({\n                            title: this.$t('stripe-shopware-payment-config-page.controller.titles.error'),\n                            message: this.$t(\n                                'stripe-shopware-payment-config-page.controller.messages.webhook.error',\n                                {\n                                    errorMessage: this.$t(\n                                        'stripe-shopware-payment-config-page.controller.messages.unknown-error',\n                                    ),\n                                },\n                            ),\n                        });\n\n                        return;\n                }\n            } catch (error) {\n                let errorMessage = error.response.data.result;\n                if (!errorMessage) {\n                    errorMessage = this.$t('stripe-shopware-payment-config-page.controller.messages.unknown-error');\n                }\n                this.createNotificationError({\n                    title: this.$t('stripe-shopware-payment-config-page.controller.titles.error'),\n                    message: this.$t(\n                        'stripe-shopware-payment-config-page.controller.messages.webhook.error',\n                        { errorMessage },\n                    ),\n                });\n            }\n        },\n\n        showCredentialsNotification() {\n            if (this.secretKeyValid && this.publishableKeyValid) {\n                this.createNotificationSuccess({\n                    title: this.$t('stripe-shopware-payment-config-page.controller.titles.success'),\n                    message: this.$t('stripe-shopware-payment-config-page.controller.messages.credentials.valid'),\n                });\n            } else {\n                const invalidFields = [];\n                if (!this.secretKeyValid) {\n                    invalidFields.push(this.$t(\n                        'stripe-shopware-payment-config-page.controller.messages.credentials.stripeSecretKey',\n                    ));\n                }\n                if (!this.publishableKeyValid) {\n                    invalidFields.push(this.$t(\n                        'stripe-shopware-payment-config-page.controller.messages.credentials.stripePublishableKey',\n                    ));\n                }\n                this.createNotificationError({\n                    title: this.$t('stripe-shopware-payment-config-page.controller.titles.error'),\n                    message: this.$t('stripe-shopware-payment-config-page.controller.messages.credentials.invalid', {\n                        invalidFields: invalidFields.join(', '),\n                    }),\n                });\n            }\n        },\n\n        getConfigValue(config, configKey) {\n            return config[`${STRIPE_CONFIG_DOMAIN}.${configKey}`];\n        },\n\n        getConfigValueWithInheritance(configKey) {\n            return this.getConfigValue(this.config, configKey) || this.getConfigValue(this.globalConfig, configKey);\n        },\n\n        async updateStripeAccountCountry() {\n            const currentSalesChannelId = this.$refs.systemConfig.currentSalesChannelId;\n            try {\n                await this.stripeShopwarePaymentConfigApiService.updateStripeAccountCountry({\n                    salesChannelId: currentSalesChannelId,\n                });\n            } catch (error) {\n                const errorMessage = error.response.data.errors[0].detail;\n                this.createNotificationError({\n                    title: this.$t('stripe-shopware-payment-config-page.controller.titles.error'),\n                    message: this.$t(\n                        'stripe-shopware-payment-config-page.controller.messages.update-account-country.error',\n                        { errorMessage },\n                    ),\n                });\n            }\n        },\n    },\n});\n","{% block stripe_settings_icon %}\n    <svg\n            width=\"24\"\n            height=\"24\"\n            viewBox=\"0 0 256 256\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n    >\n        <defs>\n            <linearGradient\n                    id=\"linearGradient\"\n                    x1=\"100%\"\n                    y1=\"58.356%\"\n                    x2=\"0%\"\n                    y2=\"0%\"\n            >\n                <stop\n                        stop-color=\"#2697D4\"\n                        offset=\"0%\"\n                />\n                <stop\n                        stop-color=\"#207BCB\"\n                        offset=\"50%\"\n                />\n                <stop\n                        stop-color=\"#2285CE\"\n                        offset=\"100%\"\n                />\n            </linearGradient>\n        </defs>\n        <path\n                d=\"M24,0 L232,0 C245.254834,-2.4348735e-15 256,10.745166 256,24 L256,232 C256,245.254834 245.254834,256 232,256 L24,256 C10.745166,256 1.623249e-15,245.254834 0,232 L0,24 C-1.623249e-15,10.745166 10.745166,2.4348735e-15 24,0 Z\"\n                style=\"fill:url(#linearGradient); fill-rule:nonzero;\"\n        />\n        <path\n                d=\"M139.688,111 C126.761,106.22 119.677,102.5 119.677,96.657 C119.677,91.697 123.75,88.865 131.011,88.865 C144.292,88.865 157.927,94.001 167.313,98.604 L172.625,65.844 C165.187,62.302 149.958,56.459 128.885,56.459 C114.011,56.459 101.615,60.354 92.761,67.615 C83.551,75.229 78.771,86.209 78.771,99.49 C78.771,123.573 93.469,133.844 117.375,142.521 C132.781,148.011 137.917,151.907 137.917,157.927 C137.917,163.771 132.957,167.135 123.927,167.135 C112.77,167.135 94.355,161.646 82.312,154.563 L77,187.677 C87.27,193.521 106.395,199.541 126.23,199.541 C141.99,199.541 155.094,195.823 163.948,188.74 C173.864,180.948 179,169.438 179,154.563 C179,129.948 163.948,119.677 139.687,111.001 L139.688,111 Z\"\n                style=\"fill:#FFFFFF; fill-rule:evenodd;\"\n        />\n    </svg>\n\n{% endblock %}\n","module.exports = window['Shopware']?.['Vue']","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createStaticVNode as _createStaticVNode } from \"vue\"\n\nconst _hoisted_1 = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"256\",\n  height: \"256\"\n}\n\nexport function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", _hoisted_1, _cache[0] || (_cache[0] = [\n    _createStaticVNode(\"<defs><linearGradient id=\\\"a\\\" x1=\\\"100%\\\" x2=\\\"0%\\\" y1=\\\"58.356%\\\" y2=\\\"0%\\\"><stop offset=\\\"0%\\\" stop-color=\\\"#2697D4\\\"></stop><stop offset=\\\"50%\\\" stop-color=\\\"#207BCB\\\"></stop><stop offset=\\\"100%\\\" stop-color=\\\"#2285CE\\\"></stop></linearGradient></defs><path d=\\\"M24 0h208c13.255 0 24 10.745 24 24v208c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V24C0 10.745 10.745 0 24 0\\\" style=\\\"fill:url(#a);fill-rule:nonzero;\\\"></path><path d=\\\"M139.688 111c-12.927-4.78-20.011-8.5-20.011-14.343 0-4.96 4.073-7.792 11.334-7.792 13.281 0 26.916 5.136 36.302 9.739l5.312-32.76c-7.438-3.542-22.667-9.385-43.74-9.385-14.874 0-27.27 3.895-36.124 11.156-9.21 7.614-13.99 18.594-13.99 31.875 0 24.083 14.698 34.354 38.604 43.031 15.406 5.49 20.542 9.386 20.542 15.406 0 5.844-4.96 9.208-13.99 9.208-11.157 0-29.572-5.489-41.615-12.572L77 187.677c10.27 5.844 29.395 11.864 49.23 11.864 15.76 0 28.864-3.718 37.718-10.801 9.916-7.792 15.052-19.302 15.052-34.177 0-24.615-15.052-34.886-39.313-43.562z\\\" style=\\\"fill:#fff;fill-rule:evenodd;\\\"></path>\", 3)\n  ])))\n}\nexport default { render: render }","import template from './stripe-settings-icon.html.twig';\r\nimport * as StripeShopwarePaymentIconPluginSvg from \"./stripe-shopware-payment-icon-plugin.svg\";\r\n\r\nconst { Component } = Shopware;\r\n\r\nComponent.register('stripe-settings-icon', {\r\n    template,\r\n    data() {\r\n        return {\r\n            svgData: StripeShopwarePaymentIconPluginSvg\r\n        }\r\n    },\r\n    computed: {\r\n        assetFilter() {\r\n            return Shopware.Filter.getByName('asset');\r\n        },\r\n    }\r\n});\r\n\r\nComponent.override('sw-icon', {\r\n    watch: {\r\n        name: {\r\n            async handler(newName) {\r\n                if (newName.indexOf('stripe-shopware-payment-icon') !== 0) {\r\n                    return;\r\n                }\r\n\r\n                // The watcher is called (for the first and in normal cases only time) before the beforeMount hook of\r\n                // the component is executed. Unfortunately shopware resets the rendered svg string in this hook,\r\n                // therefore need to wait for the next tick to ensure that our svg string gets rendered.\r\n                //\r\n                // eslint-disable-next-line max-len,vue/max-len\r\n                // See https://github.com/shopware/platform/blob/acc85ca70ac44e22ebe1e6e2a370a6d92384083c/src/Administration/Resources/app/administration/src/app/component/base/sw-icon/index.js#L122\r\n                //\r\n                // This workaround will be removed as soon as sw-icon will support loading of third party icons\r\n                // See https://github.com/pickware/shopware-plugins/issues/3924\r\n                await this.$nextTick();\r\n                switch (newName) {\r\n                    case 'stripe-shopware-payment-icon-plugin':\r\n                        this.iconSvgData = StripeShopwarePaymentIconPluginSvg;\r\n                        break;\r\n                    default:\r\n                        this.iconSvgData = '';\r\n                }\r\n            },\r\n            immediate: true,\r\n        },\r\n    },\r\n});\r\n\r\n\r\n","\r\nimport './page/stripe-plugin-settings'\r\nimport './components/stripe-settings-icon'\r\n\r\nconst { Module } = Shopware;\r\n\r\nModule.register('stripe-settings', {\r\n    name: 'stripe-settings',\r\n    type: 'plugin',\r\n    color: '#9AA8B5',\r\n    title: \"stripe-shopware-payment-config-module\",\r\n    iconComponent: 'stripe-settings-icon',\r\n\r\n    routeMiddleware(next, currentRoute) {\r\n        next(currentRoute);\r\n    },\r\n\r\n    routes: {\r\n        view: {\r\n            component: 'stripe-plugin-settings',\r\n            path: 'view',\r\n            meta: {\r\n                parentPath: 'sw.settings.index',\r\n            },\r\n        }\r\n    },\r\n\r\n    settingsItem: {\r\n        group: 'plugins',\r\n        to: 'stripe.settings.view',\r\n        backgroundEnabled: false,\r\n        iconComponent: 'stripe-settings-icon',\r\n        label: 'stripe-shopware-payment-config-module.stripe-shopware-payment',\r\n    },\r\n\r\n    snippets: {\r\n        \"de-DE\": {\r\n            \"stripe-shopware-payment-config-module\": {\r\n                \"stripe-shopware-payment\": \"Stripe\"\r\n            }\r\n        },\r\n        \"en-GB\": {\r\n            \"stripe-shopware-payment-config-module\": {\r\n                \"stripe-shopware-payment\": \"Stripe\"\r\n            }\r\n        }\r\n    },\r\n});","var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.54.2\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","import { loadStripe } from '@stripe/stripe-js';\n\nconst ApiService = Shopware.Classes.ApiService;\n\nconst API_ENDPOINT = 'stripe-payment';\n\nclass StripeShopwarePaymentConfigApiService extends ApiService {\n    constructor(httpClient, loginService) {\n        super(httpClient, loginService, API_ENDPOINT);\n    }\n\n    async validateSecretKey(stripeSecretKey) {\n        const headers = this.getBasicHeaders();\n\n        const response = await this.httpClient.post(\n            `_action/${this.getApiBasePath()}/validate-secret-key`,\n            { stripeSecretKey },\n            { headers },\n        );\n\n        return ApiService.handleResponse(response);\n    }\n\n    async validatePublishableKey(stripePublishableKey) {\n        const stripeApiClient = await loadStripe(stripePublishableKey);\n        try {\n            const result = await stripeApiClient.createToken('pii', {\n                personal_id_number: 'test',\n            });\n\n            return Boolean(result.token);\n        } catch (error) {\n            return false;\n        }\n    }\n\n    async updateStripeAccountCountry({ salesChannelId }) {\n        const headers = this.getBasicHeaders();\n\n        const response = await this.httpClient.post(\n            `_action/${this.getApiBasePath()}/update-stripe-account-country`,\n            { salesChannelId },\n            { headers },\n        );\n\n        return ApiService.handleResponse(response);\n    }\n}\n\nexport default StripeShopwarePaymentConfigApiService;\n","const ApiService = Shopware.Classes.ApiService;\n\nconst API_ENDPOINT = 'stripe-payment';\n\nclass StripeShopwarePaymentWebhookRegistrationService extends ApiService {\n    constructor(httpClient, loginService) {\n        super(httpClient, loginService, API_ENDPOINT);\n    }\n\n    async registerWebhook(salesChannelId) {\n        const headers = this.getBasicHeaders();\n\n        const response = await this.httpClient.put(\n            `_action/${this.getApiBasePath()}/register-webhook`,\n            { salesChannelId },\n            { headers },\n        );\n\n        return ApiService.handleResponse(response);\n    }\n}\n\nexport default StripeShopwarePaymentWebhookRegistrationService;\n","import StripeShopwarePaymentConfigApiService from './stripe-shopware-payment-config-api-service.js';\r\nimport StripeShopwarePaymentWebhookRegistrationService from './stripe-shopware-payment-webhook-registration-service.js';\r\n\r\nconst { Application } = Shopware;\r\n\r\nApplication.addServiceProvider('stripeShopwarePaymentWebhookRegistrationService', (container) => {\r\n    const initContainer = Application.getContainer('init');\r\n\r\n    return new StripeShopwarePaymentWebhookRegistrationService(initContainer.httpClient, container.loginService);\r\n});\r\nApplication.addServiceProvider('stripeShopwarePaymentConfigApiService', (container) => {\r\n    const initContainer = Application.getContainer('init');\r\n\r\n    return new StripeShopwarePaymentConfigApiService(initContainer.httpClient, container.loginService);\r\n});"],"names":["template$1","Component","Mixin","object","types","WEBHOOK_RESULT_CREATED","WEBHOOK_RESULT_UPDATED","WEBHOOK_RESULT_NO_CHANGES","STRIPE_CONFIG_DOMAIN","template","error","errorMessage","config","publishableKey","secretKey","validationPromises","currentSalesChannelId","invalidFields","configKey","_a","vue","_hoisted_1","render","_ctx","_cache","_openBlock","_createElementBlock","_createStaticVNode","stripeShopwarePaymentIconPlugin","StripeShopwarePaymentIconPluginSvg","newName","Module","next","currentRoute","V3_URL","V3_URL_REGEX","findScript","scripts","i","script","injectScript","params","queryString","headOrBody","registerWrapper","stripe","startTime","stripePromise","loadScript","resolve","reject","initStripe","maybeStripe","args","stripePromise$1","loadCalled","err","loadStripe","_len","_key","ApiService","API_ENDPOINT","StripeShopwarePaymentConfigApiService","httpClient","loginService","stripeSecretKey","headers","response","stripePublishableKey","stripeApiClient","salesChannelId","StripeShopwarePaymentWebhookRegistrationService","Application","container","initContainer"],"mappings":"AAAA,MAAeA,EAAA,89CCAT,WAAEC,EAAW,MAAAC,CAAK,EAAK,SACvB,CAAE,OAAAC,EAAQ,MAAAC,GAAU,SAAS,MAI7BC,EAAyB,UACzBC,EAAyB,UACzBC,EAA4B,aAC5BC,EAAuB,oDAE7BP,EAAU,SAAS,yBAA0B,CAC7C,SAAIQ,EAEA,OAAQ,CACJP,EAAM,UAAU,cAAc,CACjC,EAED,OAAQ,CACJ,kDACA,uCACH,EAED,MAAO,CACH,MAAO,CACH,UAAW,GACX,iBAAkB,GAClB,OAAQ,KACR,aAAcM,EACd,oBAAqB,GACrB,eAAgB,GAChB,gBAAiB,SAAS,QAAQ,IAAI,OAAO,OAChD,CACJ,EAED,SAAU,CACN,cAAe,CACX,OAAO,KAAK,MAAM,aAAa,iBAAiB,MAAQ,CAAE,CAC7D,CACJ,EAED,UAAW,CACP,MAAO,CAAE,MAAO,KAAK,aAAa,KAAK,GAAG,2CAA2C,CAAC,CAAG,CAC5F,EAED,QAAS,CACL,MAAM,YAAa,CACf,KAAK,UAAY,GAEjB,GAAI,CACA,MAAM,KAAK,MAAM,aAAa,QAAS,EACvC,KAAK,iBAAmB,GACxB,KAAK,0BAA0B,CAC3B,MAAO,KAAK,GAAG,+DAA+D,EAC9E,QAAS,KAAK,GAAG,sEAAsE,CAC3G,CAAiB,CACJ,OAAQE,EAAO,CACZ,KAAK,iBAAmB,GACxB,IAAIC,EAAeD,EAAM,UAAYA,EAAM,SAAS,KAC/CC,IACDA,EAAe,KAAK,GAAG,uEAAuE,GAElG,KAAK,wBAAwB,CACzB,MAAO,KAAK,GAAG,6DAA6D,EAC5E,QAAS,KAAK,GACV,qEACA,CAAE,aAAAA,CAAc,CACnB,CACrB,CAAiB,EACD,KAAK,UAAY,GAEjB,MAChB,CAKY,GAHA,MAAM,KAAK,oBAAqB,EAG5B,KAAK,gBAAkB,KAAK,eAAe,KAAK,OAAQ,iBAAiB,EACzE,GAAI,CACA,MAAM,QAAQ,IAAI,CACd,KAAK,gBAAiB,EACtB,KAAK,2BAA4B,CACzD,CAAqB,CACrB,QAA0B,CAGN,OAAO,KAAK,MAAM,aAAa,iBAAiB,KAAK,MAAM,aAAa,qBAAqB,EAC7F,MAAM,KAAK,MAAM,aAAa,QAAS,CAC3D,CAGY,KAAK,UAAY,EACpB,EAED,aAAaC,EAAQ,CACjB,KAAK,OAASA,EACd,KAAK,iBAAmB,EAC3B,EAED,MAAM,qBAAsB,CACxB,MAAMC,EAAiB,KAAK,8BAA8B,iBAAiB,EACrEC,EAAY,KAAK,8BAA8B,iBAAiB,EAChEC,EAAqB,CAAE,EAC7BA,EAAmB,KAAK,KAAK,sCAAsC,kBAC/DD,CAChB,CAAa,EACGD,EACAE,EAAmB,KAAK,KAAK,sCAAsC,uBAC/DF,CACpB,CAAiB,EAEDE,EAAmB,KAAK,EAAI,EAEhC,GAAI,CACA,CAAC,KAAK,eAAgB,KAAK,mBAAmB,EAAI,MAAM,QAAQ,IAAIA,CAAkB,CACzF,OAAQL,EAAO,CACZ,KAAK,wBAAwB,CACzB,MAAO,KAAK,GAAG,6DAA6D,EAC5E,QAAS,KAAK,GAAG,4EAA6E,CAC1F,aAAcA,EAAM,OAC5C,CAAqB,CACrB,CAAiB,EAED,MAChB,CACY,KAAK,4BAA6B,CACrC,EAED,MAAM,iBAAkB,CACpB,GAAI,CACA,MAAMM,EAAwB,KAAK,MAAM,aAAa,sBAItD,QAHiB,MAAM,KAAK,gDAAgD,gBACxEA,CACH,GACgB,OAAM,CACnB,KAAKX,EACD,KAAK,0BAA0B,CAC3B,MAAO,KAAK,GAAG,+DAA+D,EAC9E,QAAS,KAAK,GAAG,yEAAyE,CACtH,CAAyB,EACD,MACJ,KAAKC,EACD,KAAK,0BAA0B,CAC3B,MAAO,KAAK,GAAG,+DAA+D,EAC9E,QAAS,KAAK,GAAG,yEAAyE,CACtH,CAAyB,EACD,MACJ,KAAKC,EACD,MACJ,QACI,KAAK,wBAAwB,CACzB,MAAO,KAAK,GAAG,6DAA6D,EAC5E,QAAS,KAAK,GACV,wEACA,CACI,aAAc,KAAK,GACf,uEACH,CACJ,CACJ,CAC7B,CAAyB,EAED,MACxB,CACa,OAAQG,EAAO,CACZ,IAAIC,EAAeD,EAAM,SAAS,KAAK,OAClCC,IACDA,EAAe,KAAK,GAAG,uEAAuE,GAElG,KAAK,wBAAwB,CACzB,MAAO,KAAK,GAAG,6DAA6D,EAC5E,QAAS,KAAK,GACV,wEACA,CAAE,aAAAA,CAAc,CACnB,CACrB,CAAiB,CACjB,CACS,EAED,6BAA8B,CAC1B,GAAI,KAAK,gBAAkB,KAAK,oBAC5B,KAAK,0BAA0B,CAC3B,MAAO,KAAK,GAAG,+DAA+D,EAC9E,QAAS,KAAK,GAAG,2EAA2E,CAChH,CAAiB,MACE,CACH,MAAMM,EAAgB,CAAE,EACnB,KAAK,gBACNA,EAAc,KAAK,KAAK,GACpB,qFACxB,CAAqB,EAEA,KAAK,qBACNA,EAAc,KAAK,KAAK,GACpB,0FACxB,CAAqB,EAEL,KAAK,wBAAwB,CACzB,MAAO,KAAK,GAAG,6DAA6D,EAC5E,QAAS,KAAK,GAAG,8EAA+E,CAC5F,cAAeA,EAAc,KAAK,IAAI,CAC9D,CAAqB,CACrB,CAAiB,CACjB,CACS,EAED,eAAeL,EAAQM,EAAW,CAC9B,OAAON,EAAO,GAAGJ,CAAoB,IAAIU,CAAS,EAAE,CACvD,EAED,8BAA8BA,EAAW,CACrC,OAAO,KAAK,eAAe,KAAK,OAAQA,CAAS,GAAK,KAAK,eAAe,KAAK,aAAcA,CAAS,CACzG,EAED,MAAM,4BAA6B,CAC/B,MAAMF,EAAwB,KAAK,MAAM,aAAa,sBACtD,GAAI,CACA,MAAM,KAAK,sCAAsC,2BAA2B,CACxE,eAAgBA,CACpC,CAAiB,CACJ,OAAQN,EAAO,CACZ,MAAMC,EAAeD,EAAM,SAAS,KAAK,OAAO,CAAC,EAAE,OACnD,KAAK,wBAAwB,CACzB,MAAO,KAAK,GAAG,6DAA6D,EAC5E,QAAS,KAAK,GACV,uFACA,CAAE,aAAAC,CAAc,CACnB,CACrB,CAAiB,CACjB,CACS,CACJ,CACL,CAAC,ECvOD,MAAeF,EAAA,o6CFAf,IAAAU,iBGAAC,GAAiBD,EAAA,OAAO,WAAP,YAAAA,EAAqB,iBCEtC,MAAME,EAAa,CACjB,MAAO,6BACP,MAAO,MACP,OAAQ,KACV,EAEO,SAASC,EAAOC,EAAMC,EAAQ,CACnC,OAAQC,EAAU,UAAA,EAAIC,EAAmB,mBAAC,MAAOL,EAAYG,EAAO,CAAC,IAAMA,EAAO,CAAC,EAAI,CACrFG,EAAkB,kBAAC,o/BAAmhC,CAAC,CAC3iC,EAAI,CACJ,CACA,MAAeC,EAAA,CAAE,OAAQN,CAAM,kHCVzB,CAAE,UAAArB,CAAW,EAAG,SAEtBA,EAAU,SAAS,uBAAwB,CACvC,SAAAQ,EACA,MAAO,CACH,MAAO,CACH,QAASoB,CACZ,CACJ,EACD,SAAU,CACN,aAAc,CACV,OAAO,SAAS,OAAO,UAAU,OAAO,CAC3C,CACJ,CACL,CAAC,EAED5B,EAAU,SAAS,UAAW,CAC1B,MAAO,CACH,KAAM,CACF,MAAM,QAAQ6B,EAAS,CACnB,GAAIA,EAAQ,QAAQ,8BAA8B,IAAM,EAcxD,OADA,MAAM,KAAK,YACHA,EAAO,CACX,IAAK,sCACD,KAAK,YAAcD,EACnB,MACJ,QACI,KAAK,YAAc,EAC1B,CACJ,EACD,UAAW,EACd,CACJ,CACL,CAAC,EC5CD,KAAM,CAAE,OAAAE,CAAQ,EAAG,SAEnBA,EAAO,SAAS,kBAAmB,CAC/B,KAAM,kBACN,KAAM,SACN,MAAO,UACP,MAAO,wCACP,cAAe,uBAEf,gBAAgBC,EAAMC,EAAc,CAChCD,EAAKC,CAAY,CACpB,EAED,OAAQ,CACJ,KAAM,CACF,UAAW,yBACX,KAAM,OACN,KAAM,CACF,WAAY,mBACf,CACJ,CACJ,EAED,aAAc,CACV,MAAO,UACP,GAAI,uBACJ,kBAAmB,GACnB,cAAe,uBACf,MAAO,+DACV,EAED,SAAU,CACN,QAAS,CACL,wCAAyC,CACrC,0BAA2B,QAC9B,CACJ,EACD,QAAS,CACL,wCAAyC,CACrC,0BAA2B,QAC9B,CACJ,CACJ,CACL,CAAC,EC/CD,IAAIC,EAAS,2BACTC,EAAe,4CAEnB,IAAIC,EAAa,UAAsB,CAGrC,QAFIC,EAAU,SAAS,iBAAiB,gBAAiB,OAAOH,EAAQ,IAAK,CAAC,EAErEI,EAAI,EAAGA,EAAID,EAAQ,OAAQC,IAAK,CACvC,IAAIC,EAASF,EAAQC,CAAC,EAEtB,GAAKH,EAAa,KAAKI,EAAO,GAAG,EAIjC,OAAOA,CACX,CAEE,OAAO,IACT,EAEIC,EAAe,SAAsBC,EAAQ,CAC/C,IAAIC,EAAuF,GACvFH,EAAS,SAAS,cAAc,QAAQ,EAC5CA,EAAO,IAAM,GAAG,OAAOL,CAAM,EAAE,OAAOQ,CAAW,EACjD,IAAIC,EAAa,SAAS,MAAQ,SAAS,KAE3C,GAAI,CAACA,EACH,MAAM,IAAI,MAAM,6EAA6E,EAG/F,OAAAA,EAAW,YAAYJ,CAAM,EACtBA,CACT,EAEIK,EAAkB,SAAyBC,EAAQC,EAAW,CAC5D,CAACD,GAAU,CAACA,EAAO,kBAIvBA,EAAO,iBAAiB,CACtB,KAAM,YACN,QAAS,SACT,UAAWC,CACf,CAAG,CACH,EAEIC,EAAgB,KAChBC,EAAa,SAAoBP,EAAQ,CAE3C,OAAIM,IAAkB,OAItBA,EAAgB,IAAI,QAAQ,SAAUE,EAASC,EAAQ,CACrD,GAAI,OAAO,OAAW,KAAe,OAAO,SAAa,IAAa,CAGpED,EAAQ,IAAI,EACZ,MACN,CAMI,GAAI,OAAO,OAAQ,CACjBA,EAAQ,OAAO,MAAM,EACrB,MACN,CAEI,GAAI,CACF,IAAIV,EAASH,EAAY,EAErBG,GAAUE,GAEFF,IACVA,EAASC,EAAaC,CAAM,GAG9BF,EAAO,iBAAiB,OAAQ,UAAY,CACtC,OAAO,OACTU,EAAQ,OAAO,MAAM,EAErBC,EAAO,IAAI,MAAM,yBAAyB,CAAC,CAErD,CAAO,EACDX,EAAO,iBAAiB,QAAS,UAAY,CAC3CW,EAAO,IAAI,MAAM,0BAA0B,CAAC,CACpD,CAAO,CACF,OAAQxC,EAAO,CACdwC,EAAOxC,CAAK,EACZ,MACN,CACA,CAAG,GACMqC,CACT,EACII,EAAa,SAAoBC,EAAaC,EAAMP,EAAW,CACjE,GAAIM,IAAgB,KAClB,OAAO,KAGT,IAAIP,EAASO,EAAY,MAAM,OAAWC,CAAI,EAC9C,OAAAT,EAAgBC,EAAQC,CAAS,EAC1BD,CACT,EAIIS,EAAkB,QAAQ,QAAS,EAAC,KAAK,UAAY,CACvD,OAAON,EAAW,IAAI,CACxB,CAAC,EACGO,EAAa,GACjBD,EAAgB,MAAS,SAAUE,EAAK,CACjCD,GACH,QAAQ,KAAKC,CAAG,CAEpB,CAAC,EACD,IAAIC,EAAa,UAAsB,CACrC,QAASC,EAAO,UAAU,OAAQL,EAAO,IAAI,MAAMK,CAAI,EAAGC,EAAO,EAAGA,EAAOD,EAAMC,IAC/EN,EAAKM,CAAI,EAAI,UAAUA,CAAI,EAG7BJ,EAAa,GACb,IAAIT,EAAY,KAAK,IAAK,EAC1B,OAAOQ,EAAgB,KAAK,SAAUF,EAAa,CACjD,OAAOD,EAAWC,EAAaC,EAAMP,CAAS,CAClD,CAAG,CACH,EC5HA,MAAMc,EAAa,SAAS,QAAQ,WAE9BC,EAAe,iBAErB,MAAMC,UAA8CF,CAAW,CAC3D,YAAYG,EAAYC,EAAc,CAClC,MAAMD,EAAYC,EAAcH,CAAY,CACpD,CAEI,MAAM,kBAAkBI,EAAiB,CACrC,MAAMC,EAAU,KAAK,gBAAiB,EAEhCC,EAAW,MAAM,KAAK,WAAW,KACnC,WAAW,KAAK,eAAc,CAAE,uBAChC,CAAE,gBAAAF,CAAiB,EACnB,CAAE,QAAAC,CAAS,CACd,EAED,OAAON,EAAW,eAAeO,CAAQ,CACjD,CAEI,MAAM,uBAAuBC,EAAsB,CAC/C,MAAMC,EAAkB,MAAMZ,EAAWW,CAAoB,EAC7D,GAAI,CAKA,MAAO,GAJQ,MAAMC,EAAgB,YAAY,MAAO,CACpD,mBAAoB,MACpC,CAAa,GAEqB,KACzB,MAAe,CACZ,MAAO,EACnB,CACA,CAEI,MAAM,2BAA2B,CAAE,eAAAC,GAAkB,CACjD,MAAMJ,EAAU,KAAK,gBAAiB,EAEhCC,EAAW,MAAM,KAAK,WAAW,KACnC,WAAW,KAAK,eAAc,CAAE,iCAChC,CAAE,eAAAG,CAAgB,EAClB,CAAE,QAAAJ,CAAS,CACd,EAED,OAAON,EAAW,eAAeO,CAAQ,CACjD,CACA,CC/CA,MAAMP,EAAa,SAAS,QAAQ,WAE9BC,EAAe,iBAErB,MAAMU,UAAwDX,CAAW,CACrE,YAAYG,EAAYC,EAAc,CAClC,MAAMD,EAAYC,EAAcH,CAAY,CACpD,CAEI,MAAM,gBAAgBS,EAAgB,CAClC,MAAMJ,EAAU,KAAK,gBAAiB,EAEhCC,EAAW,MAAM,KAAK,WAAW,IACnC,WAAW,KAAK,eAAc,CAAE,oBAChC,CAAE,eAAAG,CAAgB,EAClB,CAAE,QAAAJ,CAAS,CACd,EAED,OAAON,EAAW,eAAeO,CAAQ,CACjD,CACA,CCjBA,KAAM,CAAE,YAAAK,CAAa,EAAG,SAExBA,EAAY,mBAAmB,kDAAoDC,GAAc,CAC7F,MAAMC,EAAgBF,EAAY,aAAa,MAAM,EAErD,OAAO,IAAID,EAAgDG,EAAc,WAAYD,EAAU,YAAY,CAC/G,CAAC,EACDD,EAAY,mBAAmB,wCAA0CC,GAAc,CACnF,MAAMC,EAAgBF,EAAY,aAAa,MAAM,EAErD,OAAO,IAAIV,EAAsCY,EAAc,WAAYD,EAAU,YAAY,CACrG,CAAC","x_google_ignoreList":[3,7]}